{% extends "layout.html" %}

{% block title %}
    Gallery
{% endblock %}

{% block main %}
    <h2 class="mb-4">{{ pet.name }}'s Gallery</h2>
    {% if photos %}
        <div class="photo-gallery row">
            {% for photo in photos %}
            <div class="card col-md-3 col-sm-6 mb-4 photo-card" data-photo-url="{{ url_for('static', filename='uploads/' + photo.image_url.replace('\\', '/')) }}">
                <img src="{{ url_for('static', filename='uploads/' + photo.image_url.replace('\\', '/')) }}" alt="Photo of {{ pet.name or 'pet' }}" class="img-fluid gallery_img"/>
                <div class="card-body text-center">
                    <h5 class="card-title">{{ photo.title or 'Untitled' }}</h5>
                    <h6 class="card-subtitle mb-2 text-body-secondary">Date: {{ photo.date_uploaded }}</h6>
                </div>
            </div>
            {% endfor %}
        </div>
    {% else %}
        <div class="d-flex flex-column justify-content-center text-center">
            <h4 class="vertical_padding">It looks like you haven't added any photos yet.</h4>
            <br>
            <h4>Click the + button to add your first one!</h4>
        </div>
    {% endif %}
    
    <!-- Add new photo button -->
    <a href="{{ url_for('gallery.upload_photo', pet_id=pet.id) }}" id="addPetBtn" class="dark_btn btn_plus d-flex align-items-center justify-content-center"><i class="fas fa-plus fa-2x"></i></a> 


    <!-- Modal for Fullscreen Photo View -->
    <div class="modal fade" id="photoModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content bg-transparent border-0">
                <div class="modal-body d-flex justify-content-center align-items-center">
                    <img id="modalImage" src="" class="img-fluid" alt="Full photo preview">
                </div>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const photoCards = document.querySelectorAll('.photo-card');
            const modalImage = document.getElementById('modalImage');
            const photoModal = new bootstrap.Modal(document.getElementById('photoModal'));
            
            photoCards.forEach(card => {
                card.addEventListener('click', function() {
                    const photoUrl = card.getAttribute('data-photo-url');
                    modalImage.src = photoUrl;
                    photoModal.show();
                });
            });
        });
    </script>
{% endblock %}
